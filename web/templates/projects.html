<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link href="https://cdn.fancygrid.com/fancy.min.css" rel="stylesheet">
    <script src="https://cdn.fancygrid.com/fancy.min.js"></script>
    <script>Fancy.MODULESDIR="https://cdn.fancygrid.com/modules/";</script>
</head>
<body>

<div id="container"></div>

<script>
    document.addEventListener("DOMContentLoaded", function() {
      new FancyGrid({
        title: 'Проекты',
        renderTo: 'container',
        width: 1000,
        height: 700,
        data: [
            {% for project in projects %}
                {
                    "name": "{{ project.name }}",
                    "url": "{{ project.url }}",
                    "last_check_at": "{{ project.last_check_at }}",
                    "last_flats": "{{ project.last_flats }}",
                    "checks": [
                        {% for check in project.checks %}
                            {"check_at": "{{ check.check_at }}", "flats": {{ check.flats }} },
                        {% endfor %}
                    ]
                },
            {% endfor %}
        ],
        theme: 'gray',
        selModel: 'row',

        events: [],

        defaults: {
          type: 'string',
          sortable: true,
          editable: false,
          resizable: false,
          align: 'center',
          cellAlign: 'center'
        },

        expander: {
          tpl: [
            '<div style="float: left;">',
              '<b>Ссылка на проект:</b> <a href={url}>{url}</a>',
            '</div>'
          ].join(""),
          dataFn: function(grid, data){
            return data;
          }
        },

        columns: [{
          index: 'name',
          title: 'Название',
          flex: 1,
        }, {
          index: 'last_flats',
          title: 'Количество квартир',
          width: 150,
          type: 'number',
        }, {
          index: 'last_check_at',
          title: 'Последнее обновление',
          flex: 1,
          type: 'date',
          sortable: false,
          format: {
            read: 'Y-m-d',
          },
        }]

      });
    });

</script>


</body>
</html>